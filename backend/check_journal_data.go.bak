package main

import (
	"app-sistem-akuntansi/config"
	"app-sistem-akuntansi/database"
	"app-sistem-akuntansi/models"
	"log"
	"time"
)

func main() {
	// Load configuration
	_ = config.LoadConfig()
	
	// Connect to database
	db := database.ConnectDB()
	
	// Check journal entries
	var count int64
	db.Model(&models.JournalEntry{}).Count(&count)
	log.Printf("Total journal entries in database: %d", count)
	
	// Check for recent journal entries
	var recentEntries []models.JournalEntry
	db.Model(&models.JournalEntry{}).
		Where("created_at >= ?", time.Now().AddDate(0, -1, 0)).
		Limit(5).
		Find(&recentEntries)
	
	log.Printf("Recent journal entries (last month): %d", len(recentEntries))
	for _, entry := range recentEntries {
		log.Printf("Entry ID: %d, Code: %s, Status: %s, Date: %s", 
			entry.ID, entry.Code, entry.Status, entry.EntryDate.Format("2006-01-02"))
	}
	
	// Check journal lines count
	var lineCount int64
	db.Model(&models.JournalLine{}).Count(&lineCount)
	log.Printf("Total journal lines in database: %d", lineCount)
	
	// Check posted entries count
	var postedCount int64
	db.Model(&models.JournalEntry{}).Where("status = ?", models.JournalStatusPosted).Count(&postedCount)
	log.Printf("Posted journal entries: %d", postedCount)
	
	log.Printf("Database check completed")
}